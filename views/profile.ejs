<%- include('partials/header') %>
<h1>Profile</h1>
<link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
<div id="user-info">
    <p id="username"><%= username %></p>
    <p id="email"><%= email %></p>
    <p id="firstName"><%= firstName %></p>
    <p id="lastName"><%= lastName %></p>
    <button id="update-profile" type="button">Edit Profile</button>
</div>

<div id="edit-user-info" style="display: none;">
    <input type="text" id="edit-username" value="<%= username %>">
    <input type="text" id="edit-email" value="<%= email %>">
    <input type="text" id="edit-firstName" value="<%= firstName %>">
    <input type="text" id="edit-lastName" value="<%= lastName %>">
    <input type="password" id="edit-password" placeholder="Enter new password">
    <button id="save-changes" type="button">Save Changes</button>
</div>

<%- include('partials/footer') %>

<script src="/scripts/updateProfile.js"></script>
<script>
    document.getElementById('update-profile').addEventListener('click', function() {
        document.getElementById('user-info').style.display = 'none';
        document.getElementById('edit-user-info').style.display = 'block';
    });

    document.getElementById('save-changes').addEventListener('click', function() {
        const username = document.getElementById('edit-username').value;
        const email = document.getElementById('edit-email').value;
        const firstName = document.getElementById('edit-firstName').value;
        const lastName = document.getElementById('edit-lastName').value;
        const password = document.getElementById('edit-password').value;

        const route = '/profile'; // Assuming this is the correct route to update the profile
        updateProfile('/profile', firstName, lastName, email, password, username)
        
        .then(response => {
    if (response.ok) {
        return response.json(); // Parse response JSON
    } else {
        throw new Error('Failed to update profile');
    }
})
.then(data => {
    console.log(data); // Log updated user data
    window.location.reload(); // Reload the page to reflect the updated changes
})
.catch(error => {
    console.error('Failed to update profile:', error);
});
    });

</script>